---
import { getCollection } from 'astro:content';

const articles = await getCollection('blog');
const recentArticles = articles
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 4);
---

<section id="articles" class="py-32 relative overflow-hidden">
  <!-- Added background decoration -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute bottom-1/3 right-1/4 w-96 h-96 bg-accent/10 rounded-full blur-3xl"></div>
  </div>

  <div class="max-w-7xl mx-auto px-6 relative z-10">
    <!-- Enhanced section header -->
    <div class="text-center mb-16">
      <p class="text-text-secondary text-sm mb-4 font-medium tracking-wider">... /Articles ...</p>
      <h2 class="text-5xl lg:text-6xl font-display mb-6 gradient-text">Latest Articles</h2>
      <p class="text-text-secondary text-lg max-w-2xl mx-auto">
        Thoughts, tutorials, and insights on web development
      </p>
    </div>

    <!-- Added empty state for articles -->
    {recentArticles.length === 0 ? (
      <div class="text-center py-20">
        <div class="glass rounded-3xl p-12 max-w-md mx-auto">
          <i class="fa-solid fa-newspaper text-6xl text-text-secondary/30 mb-6"></i>
          <h3 class="text-2xl font-display mb-4">No Articles Yet</h3>
          <p class="text-text-secondary">
            Check back soon for new articles and tutorials on web development.
          </p>
        </div>
      </div>
    ) : (
      <>
        <!-- Enhanced article grid with glassmorphism and animations -->
        <div class="grid md:grid-cols-2 gap-8">
          {recentArticles.map((article, index) => (
            <article 
              class="article-card glass rounded-3xl p-8 glass-hover border border-white/10 hover:border-secondary/50 transition-all duration-500 group"
              style={`animation-delay: ${index * 0.1}s;`}
            >
              <!-- Added category badge -->
              <div class="flex items-center justify-between mb-4">
                <span class="px-3 py-1 bg-secondary/10 text-secondary rounded-full text-xs border border-secondary/20">
                  Tutorial
                </span>
                <time class="text-xs text-text-secondary">
                  {article.data.publishDate.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                  })}
                </time>
              </div>

              <!-- Enhanced title with gradient hover effect -->
              <h3 class="text-2xl font-display mb-4 group-hover:gradient-text transition-all">
                {article.data.title}
              </h3>
              
              <p class="text-text-secondary mb-6 leading-relaxed">
                {article.data.description}
              </p>

              <!-- Enhanced read more button with gradient -->
              <a 
                href={`/blog/${article.slug}`}
                class="inline-flex items-center gap-3 px-6 py-3 gradient-bg rounded-full hover:opacity-90 transition-all text-sm font-medium group/btn glow-hover"
              >
                Read more
                <div class="w-6 h-6 bg-white/20 rounded-full flex items-center justify-center group-hover/btn:translate-x-1 transition-transform">
                  <i class="fa-solid fa-arrow-right text-xs"></i>
                </div>
              </a>
            </article>
          ))}
        </div>

        <!-- Enhanced view all link -->
        <div class="text-center mt-12">
          <a 
            href="/blog" 
            class="inline-flex items-center gap-3 px-8 py-4 glass glass-hover rounded-full font-medium group"
          >
            View all articles
            <i class="fa-solid fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
          </a>
        </div>
      </>
    )}
  </div>
</section>

<style>
  .article-card {
    opacity: 0;
    animation: fadeInUp 0.6s ease-out forwards;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
